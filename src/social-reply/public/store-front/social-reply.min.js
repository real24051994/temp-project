/* eslint-disable */
if (typeof window.checkJSES == "undefined") {
  window.checkJSES = 1;

  loadJquerySearch(function(jQuery) {
      createFacebookChat(jQuery);
  });

  function loadJquerySearch(callback) {
      if (typeof jQuery === "undefined") {
          getScript({
              source: "//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js",
              callback: () => {
                  jQuery224 = jQuery.noConflict(true);
                  callback(jQuery224);
              },
          });
      } else {
          callback(jQuery);
      }
  }

  function getScript({ source, callback }) {
      var script = document.createElement("script");
      var prior = document.getElementsByTagName("script")[0];
      script.async = 1;

      script.onload = script.onreadystatechange = function(_, isAbort) {
          if (
              isAbort ||
              !script.readyState ||
              /loaded|complete/.test(script.readyState)
          ) {
              script.onload = script.onreadystatechange = null;
              script = undefined;

              if (!isAbort) {
                  if (callback) callback();
              }
          }
      };

      script.src = source;
      prior.parentNode.insertBefore(script, prior);
  }
}

//

function createFacebookChat(jquery) {
  var $ = jquery;
  $(document).ready(function() {
      var scripts = document.getElementsByTagName("script");
      var myScript = {};
      for (var i = 0; i < scripts.length; i++) {
          var myScript1 = scripts[i];
          var src = myScript1.src;
          if (src.indexOf("social-reply.min.js") > -1) {
              myScript = myScript1;
          }
      }
      var temp = myScript.src.split("?");
      var queryString = temp[temp.length - 1];
      var params = parseQuery(queryString);

      $("body").append("<div class='srFacebookChat'></div>");

      var facebookChatSettings;
      $.ajax({
          dataType: "json",
          url: `https://${params.domain}/api/store/wiget?shop=${Shopify.shop}`,
      }).done(function(res) {
          facebookChatSettings = res.data;

          if (!facebookChatSettings || facebookChatSettings.enable == false) {
              return;
          }

          facebookChatSettings.position =
              facebookChatSettings.position_margin.horizontal || 90;

          facebookChatSettings.margin_bottom =
              facebookChatSettings.position_margin.vertical || 30;

          // Begin check pages target
          if (facebookChatSettings.visibility !== "all") {
              var pathname = window.location.pathname;
              var page_id = "";

              if (pathname === "/") {
                  page_id = "template-index";
              } else if (pathname.startsWith("/collections/")) {
                  page_id = "template-collection";
              } else if (pathname.startsWith("/products/")) {
                  page_id = "template-product";
              } else if (pathname.startsWith("/cart")) {
                  page_id = "template-cart";
              } else if (pathname.startsWith("/search")) {
                  page_id = "template-search";
              } else if (pathname.startsWith("/pages/")) {
                  var page = pathname.replace("/pages/", "");
                  page_id = "page-" + page;
              }

              if (facebookChatSettings.visibility === "specific_pages") {
                  if (facebookChatSettings.pages.indexOf(page_id) < 0) {
                      return;
                  }
              } else if (facebookChatSettings.visibility === "exclude_pages") {
                  if (facebookChatSettings.pages.indexOf(page_id) >= 0) {
                      return;
                  }
              }
          }
          // End check pages target

          // Begin check device target
          var window_width = $(window).outerWidth();
          if (
              facebookChatSettings.device_target === "desktop" &&
              window_width < 769
          ) {
              return;
          } else if (
              facebookChatSettings.device_target == "mobile" &&
              window_width > 768
          ) {
              return;
          }

          // End check device target

          var html = facebookChatInit(facebookChatSettings, jquery);

          $(".srFacebookChat").append(html);

          var position = facebookChatSettings.position;
          var tab_width = $(".ot-fb-logo").outerWidth();
          var css_tab =
              window_width -
              tab_width -
              (window_width - tab_width) * (parseInt(position) / 100) +
              "px";

          $(".ot-fb-logo.facebook-chat-button").css("right", css_tab);

          var maxZIndex = findHighestZIndex("div");

          $(".ot-fb-logo.facebook-chat-button").css("z-index", maxZIndex + 1);
      });

      $(document).on("click", ".ot-fb-logo", function(e) {
          var object = $(
              ".fb-customerchat.fb_invisible_flow.fb_iframe_widget iframe"
          );

          // $("#fb-root").css("display", "block");

          var window_width = $(window).outerWidth();

          if (window_width < 800) {
              if ($(".ot-fb-logo.redirect_icon").length > 0) {
                  var pageId = facebookChatSettings.social_id;
                  window.open("https://www.messenger.com/t/" + pageId, "_blank");
              }
          }

          if (
              object.css("max-height") === "0px" ||
              object.css("max-height") === "none"
          ) {
              FB.Event.subscribe(
                  "customerchat.show",
                  processShowDialog(object, window_width)
              );
          } else {
              FB.Event.subscribe(
                  "customerchat.hide",
                  processHideDialog(object, window_width)
              );
          }
      });

      // $(document).on("click", ".fb_dialog.fb_dialog_mobile iframe", function (e) {
      //   var window_width = $(window).outerWidth();
      //   if (window_width < 800) {
      //     if (facebookChatSettings.chat_type == "1") {
      //       var pageInfo = JSON.parse(facebookChatSettings.page_info);
      //       var pageId = pageInfo.id;
      //       window.open("https://www.messenger.com/t/" + pageId, "_blank");
      //     }
      //   }
      // });
  });
}

function facebookChatInit(facebookChatSettings, jquery) {
  console.log("facebookChatInit");

  var $ = jquery;
  var html = "";
  var windowWidth = $(window).outerWidth();
  var currentDomain =
      window.location.protocol +
      "//" +
      window.location.host +
      "/" +
      window.location.pathname +
      window.location.search;

  html +=
      makeHtml(facebookChatSettings, currentDomain, jquery) +
      styleHtml(facebookChatSettings, windowWidth, jquery);

  return html;
}

function callbackFbLoaded() {
  FB.XFBML.parse();
}

function makeHtml(facebookChatSettings, currentDomain, jquery) {
  var $ = jquery;
  var theme_color = facebookChatSettings.custom_color.theme_color;
  var greeting_message = facebookChatSettings.greeting_message || "";
  greeting_message = greeting_message
      .replace(/&/g, "&amp;")
      .replace(/>/g, "&gt;")
      .replace(/</g, "&lt;")
      .replace(/"/g, "&quot;");

  var icon_type = facebookChatSettings.icon;
  var icon_text_color = facebookChatSettings.custom_color.icon_color;
  var tab_color = facebookChatSettings.custom_color.background_color;
  var icon_size = facebookChatSettings.icon_size;
  var page_id = facebookChatSettings.social_id;

  var icon_html = get_icon_html(icon_type, icon_text_color, tab_color);

  if (facebookChatSettings.default_state == "expanded") {
      var display = "show";
  } else {
      var display = "hide";
  }

  if (facebookChatSettings.chat_type == "1") {
      var classAddIcon = "redirect_icon";
  } else {
      var classAddIcon = "";
  }

  var html = "";
  if ($("body #fb-root").length === 0) {
      html += `<div id='fb-root'></div>`;
  }

  html += `
   <script>
   window.fbAsyncInit = function() {
      FB.init({
          xfbml            : false,
          version          : 'v8.0'
      });
      FB.Event.subscribe('customerchat.load', callbackFbLoaded());
   };

   (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      js = d.createElement(s); js.id = id;
      js.src = 'https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js';
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
    </script>
    <div class='fb-customerchat'
      attribution='setup_tool'
      page_id='${page_id}'
      themeColor='${theme_color}'
      logged_in_greeting="${greeting_message}"
      logged_out_greeting="${greeting_message}"
      greeting_dialog_display='${display}'
    >
  </div>
  <div>
  <div class='ot-fb-logo ${classAddIcon} facebook-chat-button ${icon_size}' style='background-color: ${tab_color}; z-index: 9999; user-select: none;'>
      <div style='display: flex; margin: 0'>
         ${icon_html}
      </div>
   </div>
  </div>
</div>
  `;

  return html;
}

function styleHtml(facebookChatSettings, windowWidth, jquery) {
  var $ = jquery;
  var position = 100 - parseInt(facebookChatSettings.position);
  var margin_bottom = parseInt(facebookChatSettings.margin_bottom || 50);
  var html = "";
  var css_append = "";

  css_append += `.srFacebookChat .ot-fb-logo.facebook-chat-button{
    padding: 15px; 
}`;

  chat_type_css = "";

  var cssDesktop =
      windowWidth -
      360 -
      (windowWidth - 360) * (parseInt(facebookChatSettings.position) / 100) +
      "px!important;";

  var cssMbile =
      windowWidth -
      255 -
      (windowWidth - 255) * (parseInt(facebookChatSettings.position) / 100) +
      "px!important;";

  var marginBottomIframe = 50;
  var window_width = $(window).outerWidth();

  var tab_width = 60;

  switch (facebookChatSettings.icon_size) {
      case "small":
          marginBottomIframe = 50;
          tab_width = 54;
          break;
      case "medium":
          marginBottomIframe = 60;
          tab_width = 62;
          break;
      case "large":
          marginBottomIframe = 70;
          tab_width = 70;
          break;
      default:
          tab_width = 54;
          marginBottomIframe = 75;
  }

  var position = facebookChatSettings.position;

  if (window_width < 768) {
      tab_width = 60;
  }

  var css_tab =
      window_width -
      tab_width -
      (window_width - tab_width) * (parseInt(position) / 100) +
      "px";

  html += `
    <style>
    .fb_iframe_widget iframe {
        right: ${cssDesktop};
        bottom: ${margin_bottom + marginBottomIframe}px!important;
    }
    @media screen and (max-width:1025px) {
        .fb_iframe_widget iframe {
        right: 1px!important;
        bottom: 80px!important;
        bottom: ${margin_bottom + 50}px!important;
        width: 255px;
        ${chat_type_css}
        }

        .fb_iframe_widget.fb_iframe_widget_fluid iframe.fb_customer_chat_bounce_in_v2_mobile_chat_started {
        right: 0px!important;
        }
    }
    </style>
    `;

  var cssMobile = "";

  if (facebookChatSettings.chat_type == "1") {
      cssMobile = `.fb_dialog {
                display: none!important;
              }

              .ot-fb-logo.facebook-chat-button {
                display: block!important;
              }`;
  } else {
      cssMobile = `.fb_dialog {
                display: block!important;
              }

              .ot-fb-logo.facebook-chat-button {
                display: none!important;
              }`;
  }

  html += `<style type='text/css'>
             ${css_append}

            .fb_dialog {
               right: ${css_tab}!important;
            }
            
            @media screen and (min-width: 768px) {
              .fb_dialog {
                display: none!important;
              }
            }
            
            @media screen and (max-width: 769px) {
              ${cssMobile}

              .fb_dialog .fb_dialog_content iframe {
                bottom: ${margin_bottom}px!important;
                right: ${css_tab}!important;
              }

              .fb_dialog.fb_dialog_mobile  {
                bottom: ${margin_bottom}px!important;
              }
            }
            

            .ot-fb-logo.facebook-chat-button {
               background-color: #ffffff;
               fill: #0084FF;
               box-shadow: 0 3pt 12pt rgba(0,0,0,.15);
               display: table;
               float: right;
               justify-content: center;
               align-items: center;
               cursor: pointer;
               -webkit-transition: border-color .3s;
               transition: border-color .3s;
               height: auto;
               padding: 10px 15px;
               border-radius: 50%;
               width: auto;
               position: fixed;
               bottom: ${margin_bottom}px;
               right: ${position}%;
           }

        .ot-fb-logo.facebook-chat-button.small svg {
          width: 24px;
          height: 24px;
        }

        .ot-fb-logo.facebook-chat-button.medium svg {
          width: 32px;
          height: 32px;
        }
        
        .ot-fb-logo.facebook-chat-button.large svg {
          width: 40px;
          height: 40px;
        }

        </style>`;

  return html;
}

function get_icon_html(icon_type, icon_text_color, tab_color = "") {
  var icon_html;

  switch (icon_type + "") {
      case "1":
          icon_html = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g clip-path="url(#clip0)">
    <path d="M12.0024 0C5.42542 0 0.09375 4.97461 0.09375 11.111C0.09375 14.5858 1.80322 17.6884 4.48022 19.7256V24L8.47687 21.7278C9.59106 22.0488 10.7752 22.2222 12.0024 22.2222C18.5797 22.2222 23.9108 17.2473 23.9108 11.1112C23.9108 4.97461 18.5797 0 12.0024 0V0Z" fill="${icon_text_color}"/>
    <path d="M13.207 14.8676L10.1532 11.6606L4.30847 14.8676L10.7307 8.06775L13.8129 11.2184L19.5928 8.06775L13.207 14.8676Z" fill="${tab_color}"/>
    </g>
    <defs>
    <clipPath id="clip0">
    <rect width="24" height="24" fill="${tab_color}"/>
    </clipPath>
    </defs>
    </svg>
    `;
          break;
      case "2":
          icon_html = `<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24Z" fill="${icon_text_color}"/>
    <path d="M15.0168 12.4698H12.8755V20.3144H9.63132V12.4698H8.08838V9.7129H9.63132V7.92888C9.63132 6.65311 10.2373 4.6554 12.9044 4.6554L15.3075 4.66545V7.34148H13.5639C13.2779 7.34148 12.8757 7.48437 12.8757 8.09295V9.71547H15.3002L15.0168 12.4698Z" fill="${tab_color}"/>
    </svg>`;
          break;
      case "3":
          icon_html = `<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M20.1449 1.61719H3.83162C2.12599 1.61719 0.738281 3.00462 0.738281 4.71053V14.6939C0.738281 16.396 2.11995 17.7812 3.82063 17.7873V22.3176L10.3313 17.7873H20.1449C21.8506 17.7873 23.2383 16.3996 23.2383 14.6939V4.71053C23.2383 3.00462 21.8506 1.61719 20.1449 1.61719V1.61719ZM21.9199 14.6939C21.9199 15.6725 21.1237 16.4689 20.1449 16.4689H9.91763L5.13899 19.7942V16.4689H3.83162C2.85287 16.4689 2.05664 15.6725 2.05664 14.6939V4.71053C2.05664 3.73164 2.85287 2.93555 3.83162 2.93555H20.1449C21.1237 2.93555 21.9199 3.73164 21.9199 4.71053V14.6939Z" fill="${icon_text_color}"/>
    <path d="M6.76031 6.27551H17.2163V7.59387H6.76031V6.27551Z" fill="${icon_text_color}"/>
    <path d="M6.76031 9.08801H17.2163V10.4064H6.76031V9.08801Z" fill="${icon_text_color}"/>
    <path d="M6.76031 11.9005H17.2163V13.2189H6.76031V11.9005Z" fill="${icon_text_color}"/>
    </svg>`;
          break;
      case "4":
          icon_html = `<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <g clip-path="url(#clip0)">
    <path d="M22.3145 7.54883H21.6572V14.7737C21.6572 15.8986 21.0023 16.9157 19.6892 16.9157H6.82507V17.2592C6.82507 18.2537 7.95622 19.2576 9.11781 19.2576H18.9531L22.7158 21.47L22.1701 19.2576H22.3145C23.4753 19.2576 23.9992 18.2561 23.9992 17.2592V9.26389C23.9992 8.26936 23.4753 7.54883 22.3145 7.54883Z" fill="${icon_text_color}"/>
    <path d="M17.7689 2.5293H2.82748C1.51288 2.5293 0 3.69713 0 4.82282V13.8782C0 14.9149 1.28181 15.6636 2.51132 15.7791L1.71116 18.8166L6.83841 15.8002H17.7689C19.0835 15.8002 20.2966 15.0031 20.2966 13.8782V6.55194V4.82282C20.2966 3.69713 19.0827 2.5293 17.7689 2.5293ZM5.10695 10.1733C4.36144 10.1733 3.75722 9.56911 3.75722 8.8236C3.75722 8.07809 4.36144 7.47387 5.10695 7.47387C5.85168 7.47387 6.45667 8.07809 6.45667 8.8236C6.45667 9.56911 5.85168 10.1733 5.10695 10.1733ZM10.1483 10.1733C9.40281 10.1733 8.79859 9.56911 8.79859 8.8236C8.79859 8.07809 9.40281 7.47387 10.1483 7.47387C10.8938 7.47387 11.498 8.07809 11.498 8.8236C11.498 9.56911 10.8938 10.1733 10.1483 10.1733ZM15.1905 10.1733C14.445 10.1733 13.84 9.56911 13.84 8.8236C13.84 8.07809 14.445 7.47387 15.1905 7.47387C15.9344 7.47387 16.5402 8.07809 16.5402 8.8236C16.5402 9.56911 15.9344 10.1733 15.1905 10.1733Z" fill="${icon_text_color}"/>
    </g>
    <defs>
    <clipPath id="clip0">
    <rect width="23.9992" height="24" fill="white"/>
    </clipPath>
    </defs>
    </svg>`;
          break;
      case "5":
          icon_html = `<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <g clip-path="url(#clip0)">
    <path d="M21.5973 20.5858C25.7748 15.7674 24.3213 8.27677 18.6398 5.35467C16.999 2.1773 13.6826 0 9.86701 0C4.42651 0 0.000388648 4.42641 0.000388648 9.86719C0.000388648 12.2625 0.848264 14.5278 2.40212 16.3201L0.209592 18.4839C-0.234783 18.9225 0.0730449 19.6845 0.700139 19.6875L5.99495 19.7127C7.81956 22.3678 10.8338 24 14.1324 24C14.1392 24 23.294 23.9532 23.2994 23.9531C23.9244 23.9501 24.2357 23.1895 23.7899 22.7495L21.5973 20.5858ZM3.87929 15.8445C2.28475 14.247 1.40654 12.1242 1.40654 9.86719C1.40654 5.20181 5.20192 1.40625 9.86701 1.40625C14.5321 1.40625 18.3275 5.20181 18.3275 9.86719C18.3275 14.3378 14.7897 18.3642 9.59265 18.3236L2.40869 18.2894L3.87554 16.8418C4.15295 16.5679 4.15459 16.1204 3.87929 15.8445V15.8445ZM14.1324 22.5938C11.6652 22.5938 9.37197 21.5396 7.77784 19.7212C10.4546 19.7388 9.74401 19.7344 9.86701 19.7344C16.214 19.7344 20.9532 13.7808 19.4618 7.56483C23.3508 10.7417 23.6694 16.5545 20.1202 20.1102C19.8448 20.386 19.8465 20.8336 20.1239 21.1074L21.5908 22.555C21.5852 22.555 14.1379 22.5938 14.1324 22.5938Z" fill="${icon_text_color}"/>
    <path d="M5.67213 7.78125H14.1092C14.4975 7.78125 14.8123 7.46644 14.8123 7.07812C14.8123 6.68981 14.4975 6.375 14.1092 6.375H5.67213C5.28382 6.375 4.96906 6.68981 4.96906 7.07812C4.96906 7.46644 5.28387 7.78125 5.67213 7.78125Z" fill="${icon_text_color}"/>
    <path d="M5.67213 10.5938H14.1092C14.4975 10.5938 14.8123 10.2789 14.8123 9.89062C14.8123 9.50231 14.4975 9.1875 14.1092 9.1875H5.67213C5.28382 9.1875 4.96906 9.50231 4.96906 9.89062C4.96906 10.2789 5.28387 10.5938 5.67213 10.5938Z" fill="${icon_text_color}"/>
    <path d="M5.67213 13.4062H14.1092C14.4975 13.4062 14.8123 13.0914 14.8123 12.7031C14.8123 12.3148 14.4975 12 14.1092 12H5.67213C5.28382 12 4.96906 12.3148 4.96906 12.7031C4.96906 13.0914 5.28387 13.4062 5.67213 13.4062Z" fill="${icon_text_color}"/>
    </g>
    <defs>
    <clipPath id="clip0">
    <rect width="24" height="24" fill="white"/>
    </clipPath>
    </defs>
    </svg>
    `;
          break;
      case "6":
          icon_html = `<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <g clip-path="url(#clip0)">
    <path d="M22.2273 18.9786L15.9498 16.9208V14.7553C16.3981 14.0926 16.7003 13.3129 16.807 12.4688H17.94C18.9294 12.4688 19.7344 11.6638 19.7344 10.6743V8.75245C19.7344 8.37792 19.6189 8.02997 19.4219 7.74197V7.42186C19.4219 3.32944 16.0924 0 12 0C7.90758 0 4.57814 3.32944 4.57814 7.42186V7.74197C4.38112 8.03002 4.26562 8.37797 4.26562 8.75245V10.6743C4.26562 11.6638 5.07061 12.4688 6.06005 12.4688H7.19306C7.3012 13.3246 7.61058 14.1142 8.0692 14.7827V16.9147L1.77267 18.9786C0.712406 19.3262 0 20.3095 0 21.4252V24H24V21.4252C24 20.3095 23.2876 19.3262 22.2273 18.9786ZM9.47545 16.1567C10.2113 16.632 11.0759 16.9063 12 16.9063C12.9322 16.9063 13.8036 16.6271 14.5435 16.1442V17.1145C14.0097 17.5747 12.9324 18.3348 12 18.3348C11.0692 18.3348 10.0028 17.576 9.47545 17.1168V16.1567ZM15.4436 8.21213C14.4246 8.03123 13.6481 7.13962 13.6481 6.06947H12.2418C12.2418 7.26975 11.2653 8.24625 10.065 8.24625H8.55642V7.56853C8.55642 5.66977 10.1012 4.125 12 4.125C13.8988 4.125 15.4436 5.66977 15.4436 7.56853V8.21213ZM8.55642 9.70148V9.65255H10.065C11.2439 9.65255 12.2916 9.0803 12.945 8.199C13.527 8.98406 14.4218 9.52383 15.4436 9.63239V11.7892C15.4436 12.0655 15.4145 12.3345 15.3611 12.5938H12.807V14H14.7639C14.1357 14.9096 13.1307 15.5 12 15.5C10.1013 15.5 8.55647 13.8353 8.55647 11.7892V9.70148H8.55642ZM18.3281 10.6743C18.3281 10.8884 18.154 11.0625 17.94 11.0625H16.8498V8.36428H17.94C18.154 8.36428 18.3281 8.53842 18.3281 8.75245V10.6743ZM12 1.40625C15.1615 1.40625 17.7612 3.85767 17.998 6.95948C17.9787 6.95887 17.9595 6.95803 17.94 6.95803H16.8115C16.5104 4.57097 14.4675 2.71875 12 2.71875C9.53255 2.71875 7.48964 4.57097 7.18847 6.95803H6.06C6.04055 6.95803 6.02123 6.95887 6.00192 6.95948C6.23883 3.85767 8.83852 1.40625 12 1.40625V1.40625ZM5.67188 10.6743V8.75245C5.67188 8.53842 5.84602 8.36428 6.06005 8.36428H7.15017V11.0625H6.06005C5.84602 11.0625 5.67188 10.8884 5.67188 10.6743V10.6743ZM22.5938 22.5938H19.1585V21.1406H17.7522V22.5938H6.24778V21.1406H4.84153V22.5938H1.40625V21.4252C1.40625 20.9189 1.72955 20.4727 2.21077 20.3149L8.60325 18.2195C9.20981 18.7368 10.5711 19.7411 12 19.7411C13.426 19.7411 14.7959 18.7402 15.4083 18.2233L21.7893 20.315C22.2705 20.4727 22.5938 20.9189 22.5938 21.4252V22.5938Z" fill="${icon_text_color}"/>
    </g>
    <defs>
    <clipPath id="clip0">
    <rect width="24" height="24" fill="white"/>
    </clipPath>
    </defs>
    </svg>`;
          break;
      default:
  }
  return icon_html;
}

function processShowDialog(object, windowWidth) {
  if (windowWidth > 767) {
      FB.CustomerChat.show();
      object.css("max-height", "100%");
      object.css("height", "auto !important");
      object.css("user-select", "none");
      object
          .removeClass("fb_customer_chat_bounce_out_v2")
          .addClass("fb_customer_chat_bounce_in_v2");
  } else {
      FB.CustomerChat.showDialog();
  }
}

function processHideDialog(object, windowWidth) {
  if (windowWidth > 767) {
      FB.CustomerChat.hide();
      object.css("max-height", "0");
      object
          .removeClass("fb_customer_chat_bounce_in_v2")
          .addClass("fb_customer_chat_bounce_out_v2");
  } else {
      FB.CustomerChat.hideDialog();
  }
}

function findHighestZIndex(elem) {
  var elems = document.getElementsByTagName(elem);
  var highest = 0;
  for (var i = 0; i < elems.length; i++) {
      var zindex = document.defaultView
          .getComputedStyle(elems[i], null)
          .getPropertyValue("z-index");
      if (zindex > highest && zindex != "auto") {
          highest = zindex;
      }
  }
  return highest;
}

function parseQuery(query) {
  var Params = new Object();
  if (!query) return Params; // return empty object
  var Pairs = query.split(/[;&]/);
  for (var i = 0; i < Pairs.length; i++) {
      var KeyVal = Pairs[i].split("=");
      if (!KeyVal || KeyVal.length != 2) continue;
      var key = unescape(KeyVal[0]);
      var val = unescape(KeyVal[1]);
      val = val.replace(/\+/g, " ");
      Params[key] = val;
  }
  return Params;
}