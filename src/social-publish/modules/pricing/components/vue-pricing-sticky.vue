<template>
	<div>
		<a @click="onClickSticky" class="vue-pricing-sticky btn-event-show-pricing-popup btn-track-event">
			<svg  fill="none" height="111" viewBox="0 0 28 111" width="28" xmlns="http://www.w3.org/2000/svg">
				<path class="vue-pricing-sticky-bg" clip-rule="evenodd" d="M0 0H20C24.4183 0 28 3.58172 28 8V103C28 107.418 24.4183 111 20 111H0V0Z" fill="#5b86e5" fill-rule="evenodd" />
				<path
					d="M9.88 31.212C9.88 30.18 10.156 29.384 10.708 28.824C11.268 28.264 12.112 27.984 13.24 27.984L18.112 27.984C18.2 27.984 18.268 28.008 18.316 28.056C18.372 28.104 18.4 28.168 18.4 28.248L18.4 28.824C18.4 28.912 18.372 28.98 18.316 29.028C18.268 29.084 18.2 29.112 18.112 29.112L13.216 29.112C12.432 29.112 11.848 29.292 11.464 29.652C11.08 30.02 10.888 30.54 10.888 31.212C10.888 31.876 11.08 32.388 11.464 32.748C11.856 33.116 12.44 33.3 13.216 33.3L18.112 33.3C18.2 33.3 18.268 33.324 18.316 33.372C18.372 33.42 18.4 33.488 18.4 33.576L18.4 34.152C18.4 34.232 18.372 34.296 18.316 34.344C18.268 34.4 18.2 34.428 18.112 34.428L13.24 34.428C12.112 34.428 11.268 34.148 10.708 33.588C10.156 33.036 9.88 32.244 9.88 31.212ZM7.72 36.5903C7.72 36.5103 7.744 36.4423 7.792 36.3863C7.84 36.3383 7.908 36.3143 7.996 36.3143L15.964 36.3143C16.052 36.3143 16.12 36.3383 16.168 36.3863C16.216 36.4423 16.24 36.5103 16.24 36.5903L16.24 37.0943C16.24 37.1823 16.216 37.2503 16.168 37.2983C16.12 37.3463 16.052 37.3703 15.964 37.3703L15.436 37.3703C16.052 37.8343 16.36 38.4943 16.36 39.3503C16.36 40.1903 16.092 40.8183 15.556 41.2343C15.028 41.6583 14.352 41.8823 13.528 41.9063C13.44 41.9143 13.304 41.9183 13.12 41.9183C12.936 41.9183 12.8 41.9143 12.712 41.9063C11.896 41.8823 11.22 41.6583 10.684 41.2343C10.148 40.8183 9.88 40.1903 9.88 39.3503C9.88 38.4943 10.184 37.8463 10.792 37.4063L7.996 37.4063C7.916 37.4063 7.852 37.3783 7.804 37.3223C7.748 37.2743 7.72 37.2103 7.72 37.1303L7.72 36.5903ZM10.816 39.1223C10.816 39.6983 10.996 40.1183 11.356 40.3823C11.716 40.6463 12.188 40.7903 12.772 40.8143C12.852 40.8223 12.968 40.8263 13.12 40.8263C14.656 40.8263 15.424 40.2583 15.424 39.1223C15.424 38.5623 15.236 38.1383 14.86 37.8503C14.492 37.5703 14.056 37.4223 13.552 37.4063C13.464 37.3983 13.308 37.3943 13.084 37.3943C12.86 37.3943 12.704 37.3983 12.616 37.4063C12.128 37.4223 11.704 37.5743 11.344 37.8623C10.992 38.1583 10.816 38.5783 10.816 39.1223ZM7.36 45.9593C7.36 45.2953 7.472 44.7633 7.696 44.3633C7.92 43.9633 8.176 43.6793 8.464 43.5113C8.752 43.3513 9 43.2713 9.208 43.2713C9.28 43.2713 9.344 43.2993 9.4 43.3553C9.448 43.4113 9.472 43.4753 9.472 43.5473L9.472 44.0753C9.472 44.1473 9.456 44.2073 9.424 44.2553C9.384 44.3033 9.316 44.3433 9.22 44.3753C8.58 44.5993 8.26 45.1073 8.26 45.8993C8.26 46.4993 8.388 46.9433 8.644 47.2313C8.9 47.5193 9.352 47.6633 10 47.6633L10.828 47.6633C10.236 47.1993 9.94 46.5513 9.94 45.7193C9.94 44.8713 10.212 44.2353 10.756 43.8113C11.3 43.3953 11.988 43.1753 12.82 43.1513L13.156 43.1393L13.48 43.1513C14.304 43.1753 14.988 43.3953 15.532 43.8113C16.084 44.2353 16.36 44.8713 16.36 45.7193C16.36 46.5593 16.052 47.2153 15.436 47.6873L15.952 47.6873C16.032 47.6873 16.1 47.7113 16.156 47.7593C16.212 47.8153 16.24 47.8833 16.24 47.9633L16.24 48.4793C16.24 48.5593 16.212 48.6233 16.156 48.6713C16.1 48.7273 16.032 48.7553 15.952 48.7553L10.132 48.7553C8.284 48.7553 7.36 47.8233 7.36 45.9593ZM10.876 45.9353C10.876 46.4953 11.056 46.9153 11.416 47.1953C11.784 47.4833 12.224 47.6393 12.736 47.6633C12.808 47.6713 12.948 47.6753 13.156 47.6753C13.356 47.6753 13.492 47.6713 13.564 47.6633C14.076 47.6393 14.512 47.4833 14.872 47.1953C15.24 46.9153 15.424 46.4953 15.424 45.9353C15.424 45.3593 15.24 44.9393 14.872 44.6753C14.512 44.4193 14.044 44.2793 13.468 44.2553L13.156 44.2433L12.832 44.2553C12.256 44.2793 11.784 44.4193 11.416 44.6753C11.056 44.9393 10.876 45.3593 10.876 45.9353ZM10 50.8401C10 50.7601 10.024 50.6921 10.072 50.6361C10.128 50.5881 10.196 50.5641 10.276 50.5641L15.952 50.5641C16.032 50.5641 16.1 50.5881 16.156 50.6361C16.212 50.6921 16.24 50.7601 16.24 50.8401L16.24 51.3441C16.24 51.4321 16.212 51.5001 16.156 51.5481C16.108 51.6041 16.04 51.6321 15.952 51.6321L15.424 51.6321C15.968 51.9601 16.24 52.5161 16.24 53.3001L16.24 53.7681C16.24 53.8561 16.216 53.9241 16.168 53.9721C16.12 54.0201 16.052 54.0441 15.964 54.0441L15.52 54.0441C15.44 54.0441 15.372 54.0201 15.316 53.9721C15.268 53.9241 15.244 53.8561 15.244 53.7681L15.244 53.0841C15.244 52.6441 15.116 52.2961 14.86 52.0401C14.604 51.7921 14.256 51.6681 13.816 51.6681L10.276 51.6681C10.196 51.6681 10.128 51.6401 10.072 51.5841C10.024 51.5281 10 51.4601 10 51.3801L10 50.8401ZM9.88 56.71C9.88 56.318 9.96 55.954 10.12 55.618C10.28 55.29 10.496 55.026 10.768 54.826C11.048 54.634 11.356 54.538 11.692 54.538C12.22 54.538 12.652 54.754 12.988 55.186C13.324 55.618 13.548 56.206 13.66 56.95L13.912 58.75L14.26 58.75C15.084 58.75 15.496 58.274 15.496 57.322C15.496 56.954 15.42 56.658 15.268 56.434C15.124 56.21 14.952 56.046 14.752 55.942C14.672 55.91 14.616 55.874 14.584 55.834C14.56 55.802 14.548 55.754 14.548 55.69L14.548 55.222C14.548 55.15 14.572 55.086 14.62 55.03C14.676 54.982 14.74 54.958 14.812 54.958C14.996 54.958 15.208 55.042 15.448 55.21C15.696 55.386 15.908 55.654 16.084 56.014C16.268 56.374 16.36 56.814 16.36 57.334C16.36 58.23 16.152 58.87 15.736 59.254C15.32 59.646 14.8 59.842 14.176 59.842L10.276 59.842C10.196 59.842 10.128 59.814 10.072 59.758C10.024 59.71 10 59.646 10 59.566L10 59.038C10 58.958 10.024 58.894 10.072 58.846C10.128 58.798 10.196 58.774 10.276 58.774L10.804 58.774C10.54 58.598 10.32 58.342 10.144 58.006C9.968 57.67 9.88 57.238 9.88 56.71ZM10.756 56.95C10.756 57.478 10.928 57.91 11.272 58.246C11.616 58.582 12.116 58.75 12.772 58.75L13.108 58.75L12.904 57.346C12.824 56.77 12.688 56.334 12.496 56.038C12.304 55.742 12.064 55.594 11.776 55.594C11.448 55.594 11.196 55.726 11.02 55.99C10.844 56.262 10.756 56.582 10.756 56.95ZM9.88 63.8597C9.88 63.0197 10.152 62.3877 10.696 61.9637C11.24 61.5477 11.928 61.3237 12.76 61.2917L13.12 61.2797L13.48 61.2917C14.304 61.3237 14.988 61.5517 15.532 61.9757C16.084 62.3997 16.36 63.0277 16.36 63.8597C16.36 64.6917 16.064 65.3397 15.472 65.8037L18.244 65.8037C18.324 65.8037 18.388 65.8277 18.436 65.8757C18.492 65.9317 18.52 65.9997 18.52 66.0797L18.52 66.6197C18.52 66.6997 18.492 66.7637 18.436 66.8117C18.388 66.8677 18.324 66.8957 18.244 66.8957L10.276 66.8957C10.196 66.8957 10.128 66.8677 10.072 66.8117C10.024 66.7637 10 66.6997 10 66.6197L10 66.1037C10 66.0237 10.024 65.9597 10.072 65.9117C10.128 65.8637 10.196 65.8397 10.276 65.8397L10.792 65.8397C10.184 65.3837 9.88 64.7237 9.88 63.8597ZM10.816 64.0877C10.816 64.6477 11 65.0677 11.368 65.3477C11.744 65.6277 12.188 65.7797 12.7 65.8037C12.788 65.8117 12.94 65.8157 13.156 65.8157C13.38 65.8157 13.536 65.8117 13.624 65.8037C14.112 65.7877 14.532 65.6317 14.884 65.3357C15.244 65.0477 15.424 64.6317 15.424 64.0877C15.424 63.5117 15.244 63.0917 14.884 62.8277C14.524 62.5637 14.052 62.4197 13.468 62.3957L13.12 62.3837C11.584 62.3837 10.816 62.9517 10.816 64.0877ZM9.88 71.1767C9.88 70.3607 10.132 69.7087 10.636 69.2207C11.148 68.7327 11.844 68.4647 12.724 68.4167L13.132 68.4047L13.528 68.4167C14.392 68.4647 15.08 68.7327 15.592 69.2207C16.104 69.7087 16.36 70.3607 16.36 71.1767C16.36 72.0567 16.08 72.7367 15.52 73.2167C14.96 73.7047 14.2 73.9487 13.24 73.9487L13.024 73.9487C12.944 73.9487 12.876 73.9207 12.82 73.8647C12.772 73.8167 12.748 73.7527 12.748 73.6727L12.748 69.5087L12.64 69.5087C12.12 69.5327 11.676 69.6927 11.308 69.9887C10.94 70.2847 10.756 70.6767 10.756 71.1647C10.756 71.5407 10.828 71.8447 10.972 72.0767C11.124 72.3167 11.28 72.4967 11.44 72.6167C11.536 72.6887 11.592 72.7447 11.608 72.7847C11.632 72.8247 11.644 72.8927 11.644 72.9887L11.644 73.5167C11.644 73.5887 11.624 73.6487 11.584 73.6967C11.544 73.7527 11.492 73.7807 11.428 73.7807C11.252 73.7807 11.04 73.6727 10.792 73.4567C10.544 73.2407 10.328 72.9327 10.144 72.5327C9.968 72.1407 9.88 71.6887 9.88 71.1767ZM13.564 72.8567L13.6 72.8567C14.16 72.8567 14.616 72.7047 14.968 72.4007C15.32 72.0967 15.496 71.6887 15.496 71.1767C15.496 70.6567 15.32 70.2487 14.968 69.9527C14.616 69.6567 14.16 69.5087 13.6 69.5087L13.564 69.5087L13.564 72.8567ZM10 78.7809C10 78.7009 10.024 78.6369 10.072 78.5889C10.128 78.5409 10.196 78.5169 10.276 78.5169L18.112 78.5169C18.2 78.5169 18.268 78.5409 18.316 78.5889C18.372 78.6369 18.4 78.7009 18.4 78.7809L18.4 81.8169C18.4 82.7209 18.18 83.4289 17.74 83.9409C17.308 84.4609 16.676 84.7209 15.844 84.7209C15.012 84.7209 14.38 84.4609 13.948 83.9409C13.516 83.4289 13.3 82.7209 13.3 81.8169L13.3 79.6569L10.276 79.6569C10.196 79.6569 10.128 79.6289 10.072 79.5729C10.024 79.5249 10 79.4609 10 79.3809L10 78.7809ZM14.272 81.7569C14.272 82.9649 14.796 83.5689 15.844 83.5689C16.356 83.5689 16.748 83.4169 17.02 83.1129C17.292 82.8169 17.428 82.3649 17.428 81.7569L17.428 79.6569L14.272 79.6569L14.272 81.7569ZM10 86.3364C10 86.2564 10.024 86.1884 10.072 86.1324C10.128 86.0844 10.196 86.0604 10.276 86.0604L18.244 86.0604C18.332 86.0604 18.4 86.0844 18.448 86.1324C18.496 86.1884 18.52 86.2564 18.52 86.3364L18.52 86.8644C18.52 86.9444 18.492 87.0084 18.436 87.0564C18.388 87.1124 18.324 87.1404 18.244 87.1404L10.276 87.1404C10.196 87.1404 10.128 87.1124 10.072 87.0564C10.024 87.0084 10 86.9444 10 86.8644L10 86.3364ZM9.88 90.671C9.88 90.279 9.96 89.915 10.12 89.579C10.28 89.251 10.496 88.987 10.768 88.787C11.048 88.595 11.356 88.499 11.692 88.499C12.22 88.499 12.652 88.715 12.988 89.147C13.324 89.579 13.548 90.167 13.66 90.911L13.912 92.711L14.26 92.711C15.084 92.711 15.496 92.235 15.496 91.283C15.496 90.915 15.42 90.619 15.268 90.395C15.124 90.171 14.952 90.007 14.752 89.903C14.672 89.871 14.616 89.835 14.584 89.795C14.56 89.763 14.548 89.715 14.548 89.651L14.548 89.183C14.548 89.111 14.572 89.047 14.62 88.991C14.676 88.943 14.74 88.919 14.812 88.919C14.996 88.919 15.208 89.003 15.448 89.171C15.696 89.347 15.908 89.615 16.084 89.975C16.268 90.335 16.36 90.775 16.36 91.295C16.36 92.191 16.152 92.831 15.736 93.215C15.32 93.607 14.8 93.803 14.176 93.803L10.276 93.803C10.196 93.803 10.128 93.775 10.072 93.719C10.024 93.671 10 93.607 10 93.527L10 92.999C10 92.919 10.024 92.855 10.072 92.807C10.128 92.759 10.196 92.735 10.276 92.735L10.804 92.735C10.54 92.559 10.32 92.303 10.144 91.967C9.968 91.631 9.88 91.199 9.88 90.671ZM10.756 90.911C10.756 91.439 10.928 91.871 11.272 92.207C11.616 92.543 12.116 92.711 12.772 92.711L13.108 92.711L12.904 91.307C12.824 90.731 12.688 90.295 12.496 89.999C12.304 89.703 12.064 89.555 11.776 89.555C11.448 89.555 11.196 89.687 11.02 89.951C10.844 90.223 10.756 90.543 10.756 90.911ZM10 95.8166C10 95.7366 10.024 95.6686 10.072 95.6126C10.128 95.5646 10.196 95.5406 10.276 95.5406L15.964 95.5406C16.044 95.5406 16.108 95.5646 16.156 95.6126C16.212 95.6686 16.24 95.7366 16.24 95.8166L16.24 96.3326C16.24 96.4206 16.216 96.4886 16.168 96.5366C16.12 96.5846 16.052 96.6086 15.964 96.6086L15.436 96.6086C15.732 96.8486 15.96 97.1246 16.12 97.4366C16.28 97.7566 16.36 98.1526 16.36 98.6246C16.36 99.3926 16.112 99.9886 15.616 100.413C15.128 100.837 14.48 101.049 13.672 101.049L10.276 101.049C10.196 101.049 10.128 101.021 10.072 100.965C10.024 100.917 10 100.853 10 100.773L10 100.221C10 100.141 10.024 100.073 10.072 100.017C10.128 99.9686 10.196 99.9446 10.276 99.9446L13.6 99.9446C14.176 99.9446 14.624 99.8046 14.944 99.5246C15.264 99.2446 15.424 98.8446 15.424 98.3246C15.424 97.8126 15.26 97.4046 14.932 97.1006C14.612 96.7966 14.168 96.6446 13.6 96.6446L10.276 96.6446C10.196 96.6446 10.128 96.6166 10.072 96.5606C10.024 96.5126 10 96.4486 10 96.3686L10 95.8166Z"
					fill="white"
				/>
				<path
					d="M20.4375 12.4531L16.4453 11.8789L14.6406 8.24219C14.3398 7.61328 13.4102 7.58594 13.082 8.24219L11.3047 11.8789L7.28516 12.4531C6.57422 12.5625 6.30078 13.4375 6.82031 13.957L9.69141 16.7734L9.00781 20.7383C8.89844 21.4492 9.66406 21.9961 10.293 21.668L13.875 19.7812L17.4297 21.668C18.0586 21.9961 18.8242 21.4492 18.7148 20.7383L18.0312 16.7734L20.9023 13.957C21.4219 13.4375 21.1484 12.5625 20.4375 12.4531ZM16.6094 16.3086L17.2656 20.082L13.875 18.3047L10.457 20.082L11.1133 16.3086L8.35156 13.6289L12.1523 13.082L13.875 9.63672L15.5703 13.082L19.3711 13.6289L16.6094 16.3086Z"
					fill="white"
				/>
			</svg>
		</a>
		<a-modal :centered="true" :closeable="!is_loading" :destroyOnClose="true" :footer="false" :title="false" class="vue-pricing-modal" maskTransitionName="none" transitionName="none" v-if="visible && next_plan" v-model="visible" width="900px">
			<div class="vue-pricing-modal-wrapper">
				<div class="vue-pricing-modal-carousel">
					<div class="item-pricing-plan">
						<div class="item-pricing-plan-header">
							<div class="item-pricing-plan-name">
								<span>{{ next_plan.name }}</span>
							</div>
						</div>
						<div class="item-pricing-plan-body">
							<div class="item-pricing-plan-icon">
								<img :src="next_plan.icon" alt v-if="next_plan.icon" />
							</div>
							<div class="item-pricing-plan-cost">
								<strong>${{ next_plan.cost }}</strong>
								<span>/mon</span>
							</div>
							<div class="item-pricing-plan-advance">
								<ul>
									<li v-if="next_plan.socials.hasOwnProperty('limit')">
										<template v-if="next_plan.socials.limit == 'unlimited'">
											Connect unlimited
											<strong>social accounts</strong>
										</template>
										<template v-else>
											Connect {{next_plan.socials.limit}}
											<strong>social accounts</strong>
										</template>
									</li>
									<li v-if="next_plan.posts.hasOwnProperty('limit')">
										<template v-if="next_plan.posts.limit == 'unlimited'">
											Unlimited
											<strong>posts</strong> in a month
										</template>
										<template v-else>
											Limited {{next_plan.posts.limit}}
											<strong>posts</strong> in a month
										</template>
									</li>
									<li v-if="next_plan.autopilots.hasOwnProperty('limit')">
										<template v-if="next_plan.autopilots.limit == 'unlimited'">
											Set up unlimited
											<strong>Autopilots</strong>
										</template>
										<template v-else>
											Set up {{next_plan.autopilots.limit}}
											<strong>Autopilots</strong>
										</template>
									</li>
									<li v-if="next_plan.autopilots.hasOwnProperty('discount')">
										<template v-if="next_plan.autopilots.discount">Product Discount Generator</template>
										<template v-else>None Discount Generator</template>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
				<div class="vue-pricing-modal-content">
					<div class="content-inner">
						<div class="content-header">
							<div class="content-title">Upgrade to {{ next_plan.name }} now!</div>
							<div class="content-description">Reaching out to more customers and unlock all doors to your success.</div>
							<div class="content-sub-description">
								For an additional ${{ next_plan.cost }} every month,
								<br />you can get Socialpublish most popular plan
							</div>
							<div class="content-upgrade">
								<a-button :data-plan="next_plan.id" :loading="is_loading" @click="onChart" class="btn-event-upgrade btn-track-event" data-position="popup" data-status="start-trial" type="primary" v-if="trial">Start Free Trial</a-button>
								<a-button :data-plan="next_plan.id" :loading="is_loading" @click="onChart" class="btn-event-upgrade btn-track-event" data-position="popup" data-status="upgrade" type="primary" v-else>Upgrade Plan</a-button>
							</div>
							<div class="content-more-info">
								<a @click="viewMore">Or see all of our plans here</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</a-modal>
	</div>
</template>
<script>
import { mapGetters } from "vuex";
import Charge from "../mixins/charge";
export default {
	name: "VuePricingSticky",
	mixins: [Charge],
	data() {
		return {
			visible: false,
			is_loading: false
		};
	},
	computed: {
		...mapGetters({
			sticky_plans: "pricing/getPlanSticky",
			plan: "pricing/getUserPlan",
			plans: "pricing/getPricingPlans",
			plan_names: "pricing/getPricingPlanNames",
			trial: "pricing/getTrial"
		}),
		next_plan() {
			var index = this.plan_names.indexOf(this.plan.id);
			if (index < this.plan_names.length) {
				var next_plan = this.plan_names[index + 1];
				if (this.plans.hasOwnProperty(next_plan)) {
					return this.plans[next_plan];
				}
			}
			return null;
		}
	},
	methods: {
		onChart() {
			if (this.is_loading) return;
			this.is_loading = true;
			this.generalCharge(this.next_plan.id)
				.then(() => {
					this.is_loading = false;
				})
				.catch(() => {
					this.is_loading = false;
				});
		},
		viewMore() {
			this.redirect({
				name: "Pricing"
			});
			this.visible = false;
		},
		onClickSticky() {
			this.visible = true;
		}
	}
};
</script>
<style lang="scss" scoped >
.vue-pricing-sticky {
	position: fixed;
	z-index: 503;
	left: $app-sidebar-width;
	bottom: 75px;
	cursor: pointer;
	.vue-pricing-sticky-bg {
		fill: $primary-color;
	}
	&:hover {
		.vue-pricing-sticky-bg {
			fill: $warning;
		}
	}
}
.vue-pricing-modal-wrapper {
	min-height: 400px;
	.item-pricing-plan {
		height: 400px;
		&-body {
			min-height: auto;
		}
	}
}
</style>